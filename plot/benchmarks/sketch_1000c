WARNING:root:Bagua cannot detect bundled NCCL library, Bagua will try to use system NCCL instead. If you encounter any error, please run `import bagua_core; bagua_core.install_deps()` or the `bagua_install_deps.py` script to install bundled libraries.
WARNING:root:Bagua cannot detect bundled NCCL library, Bagua will try to use system NCCL instead. If you encounter any error, please run `import bagua_core; bagua_core.install_deps()` or the `bagua_install_deps.py` script to install bundled libraries.

PYDEV DEBUGGER WARNING:
sys.settrace() should not be used when the debugger is being used.
This may cause the debugger to stop working correctly.
If this is needed, please check: 
http://pydev.blogspot.com/2007/06/why-cant-pydev-debugger-work-with.html
to see how to restore the debug tracing back correctly.
Call Location:
  File "/home/ubuntu/.local/lib/python3.8/site-packages/gevent/threadpool.py", line 157, in _before_run_task
    _sys.settrace(_get_thread_trace())


PYDEV DEBUGGER WARNING:
sys.settrace() should not be used when the debugger is being used.
This may cause the debugger to stop working correctly.
If this is needed, please check: 
http://pydev.blogspot.com/2007/06/why-cant-pydev-debugger-work-with.html
to see how to restore the debug tracing back correctly.
Call Location:
  File "/home/ubuntu/.local/lib/python3.8/site-packages/gevent/threadpool.py", line 162, in _after_run_task
    _sys.settrace(None)

INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
INFO:root:Model: resnet50
INFO:root:Batch size: 32
INFO:root:Number of GPUs: 1
INFO:root:Running warmup...
Bandwidth savings: from 25557032 to 10000 (2555.70x)
INFO:root:BatchIdx: 0 TrainLoss: 6.914067
INFO:root:Running benchmark...
INFO:root:BatchIdx: 10 TrainLoss: 8.238524
INFO:root:Iter #0: 41.5 img/sec GPU
INFO:root:BatchIdx: 20 TrainLoss: 4.125323
INFO:root:Iter #1: 41.4 img/sec GPU
INFO:root:BatchIdx: 30 TrainLoss: 3.394428
INFO:root:Iter #2: 41.3 img/sec GPU
INFO:root:BatchIdx: 40 TrainLoss: 2.715346
INFO:root:Iter #3: 41.1 img/sec GPU
INFO:root:BatchIdx: 50 TrainLoss: 2.204216
INFO:root:Iter #4: 41.0 img/sec GPU
INFO:root:BatchIdx: 60 TrainLoss: 1.594402
INFO:root:Iter #5: 40.9 img/sec GPU
INFO:root:BatchIdx: 70 TrainLoss: 0.669099
INFO:root:Iter #6: 40.8 img/sec GPU
INFO:root:BatchIdx: 80 TrainLoss: 0.415994
INFO:root:Iter #7: 40.7 img/sec GPU
INFO:root:BatchIdx: 90 TrainLoss: 0.158451
INFO:root:Iter #8: 40.6 img/sec GPU
INFO:root:BatchIdx: 100 TrainLoss: 0.080668
INFO:root:Iter #9: 40.5 img/sec GPU
INFO:root:BatchIdx: 110 TrainLoss: 0.054508
INFO:root:Iter #10: 40.5 img/sec GPU
INFO:root:BatchIdx: 120 TrainLoss: 0.040210
INFO:root:Iter #11: 40.5 img/sec GPU
INFO:root:BatchIdx: 130 TrainLoss: 0.032953
INFO:root:Iter #12: 40.5 img/sec GPU
INFO:root:BatchIdx: 140 TrainLoss: 0.027784
INFO:root:Iter #13: 40.3 img/sec GPU
INFO:root:BatchIdx: 150 TrainLoss: 0.023000
INFO:root:Iter #14: 40.3 img/sec GPU
INFO:root:BatchIdx: 160 TrainLoss: 0.020159
INFO:root:Iter #15: 40.2 img/sec GPU
INFO:root:BatchIdx: 170 TrainLoss: 0.017742
INFO:root:Iter #16: 40.2 img/sec GPU
INFO:root:BatchIdx: 180 TrainLoss: 0.015806
INFO:root:Iter #17: 40.2 img/sec GPU
INFO:root:BatchIdx: 190 TrainLoss: 0.013989
INFO:root:Iter #18: 40.1 img/sec GPU
INFO:root:BatchIdx: 200 TrainLoss: 0.012272
INFO:root:Iter #19: 40.1 img/sec GPU
INFO:root:Img/sec per GPU: 40.6 +-0.8
INFO:root:Total img/sec on 1 GPU(s): 40.6 +-0.8
